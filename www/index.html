<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Univers du cuir</title>
    <link rel="stylesheet" type="text/css" href="css/index.css" />
	<link rel="stylesheet" href="js/assets/jquery.signaturepad.css">
<!--[if lt IE 9]><script src="js/assets/flashcanvas.js"></script><![endif]-->
    <script src="js/jquery-1.8.3.min.js"></script>
    <script src="util.js"></script>
    <script src="index.js"></script>
    <script src="DB.js"></script>
    <script src="js/jquery.signaturepad.js"></script>
    <script src="js/assets/json2.min.js"></script>
    <script type="text/javascript" src="phonegap.js"></script>
</head>
<body>
<div id="Init" class="Panneau current">
    <img src="images/logo.png" class="Logo">
    <h2>Initialisation</h2><br/>
    <p><a class="rouge" onClick="Init()">Initialiser</a></p><br/>
    <img src="images/loader.gif" class="loader">
    <p id="InitResult"></p>
</div>
<div id="Connexion" class="Panneau">
    <img src="images/logo.png" class="Logo">
    <form name="ident" id="ident" action="#" method="post">
    <h2>Veuillez vous identifier</h2><br/>
    <table id="tcon">
    <tr><td align="right">Nom : </td><td><input type="text" name="User" id="User" size="20" required/></td></tr>
    <tr><td align="right">Mot de passe : </td><td><input type="password" name="Psw" id="Psw" size="20" required/></td></tr>
    <tr><td></td><td align="left"><input type="button" id="btnlog" value="OK" onClick="dbu.login()"/></td></tr>
    </table>
    </form>
    <p id="rechmod"></p>
</div>
<div id="Main" class="Panneau">
    <img src="images/logo.png" class="Logo">
    <h2>Sélectionnez votre choix</h2><br/>
    <p><a onClick="">Nouvelle vente</a></p><br/>
    <p id="lienconsulthist"><a onClick="">Consulter l'historique</a></p><br/>
    <p><a onClick="Go('Tarif')">Tarif</a></p><br/>
    <p><a onClick="">Photos</a></p><br/>
    <p><a onClick="">Fiches techniques</a></p><br/>
    <p><a onClick="dbu.logout()">Se déconnecter</a></p><br/>
    <p><a onClick="SynchroAll()">Synchronisation</a></p><br/>
    <p><a onClick="Go('SQL')">SQL</a></p><br/>
</div>
<div id="Tarif" class="Panneau">
	<a onClick="Go('Main')" class="bRetour">Retour</a>
    <h1 class="ML10 MT10">Tarif</h1>
    <div id="LeModele" class="ML10">
        <div class="floatleft">
            <p>Modèle : <button id="RechMod" onClick="InitRech('Modeles')">Choisir</button></p>
            <p id="NomMod"></p>
        </div>
        <div class="floatleft ML15">
            <p>Type de cuir : <button id="RechCuir" onClick="InitRech('TypeCuir')">Choisir</button></p>
            <p id="NomCuir"></p>
        </div>
        <div class="floatleft ML15">
            <p>Couleur : <button id="RechCouleur">Choisir</button></p>
            <p id="NomCoul"></p>
        </div>
        <div class="floatleft ML15">
            <p>Options : <button id="RechOptions">Choisir</button></p>
            <p id="NomOption"></p>
        </div>
        <div class="clear"></div>
    </div>
    <div id="trfResult"></div>
    <div id="trfElems">
        <div><table><thead class="fixedHeader"><tr><th align="left">Elément</th><th align="left">Description</th><th align="right">Prix&nbsp;&nbsp;&nbsp;&nbsp;</th></tr></thead></table></div>
        <div id="trfLesElems">
        <table id="LesElems" class="scrollContent">
        <!-- <tr><td>123456</td><td>dffdsfkjhg lkdfjgh ldfskgjhlruhksjhglkdfjhgldfkj</td><td align="right">12.00 €</td></tr> -->
        </table>
        </div>
    </div>
    <script>
	var unModele={}
	function InfoModele() {
		unModele=new Modele();
		unModele.init($('#ValRech').val(), function() {
			if (unModele.Existe==true) {
				dump(unModele,'log');
				var ret='<h2>'+unModele.MOUC+'</h2><p>Délai : '+unModele.MODELAI+' semaines</p><br/>';
				var l=unModele.Elements.length;
				$('#LesElems').html('');
				for(cpt=0;cpt<l;cpt++) {
					var el='<tr><td>'+unModele.Elements[cpt].ELCODE+'</td><td>'+unModele.Elements[cpt].ELFR+'</td><td align="right" id="trfpx'+unModele.Elements[cpt].ELCODE+'></td></tr>';
					$('#LesElems').append(el);
				}
/*				ret=ret+'<br/><p>Cuirs :</p>';
				l=unModele.CatCuir.length;
				for(cpt=0;cpt<l;cpt++) {
					ret=ret+'<p>'+unModele.CatCuir[cpt].CUCAT+' - '+unModele.CatCuir[cpt].CUIRNR+' - '+unModele.CatCuir[cpt].CUIRUC+'</p>';
				}
				l=unModele.Opti.length;
				ret=ret+'<br/><p>Options : ('+l+')</p>';
				for(cpt=0;cpt<l;cpt++) {
					ret=ret+'<p>'+unModele.Opti[cpt].OPCODE+' - '+unModele.Opti[cpt].OPFR+'</p>';
				}*/
				$('#trfResult').html(ret);
			} else {
				$('#trfResult').html('<p>Modèle innexistant</p>');
			}
		});
	}
	</script>
</div>
<div class="PanneauRech">
	<div class="HeaderPanRech">
    	<p>
        <span id="txtrech">Rechercher</span> :<br/>
        <input type="text" name="Rech" id="ChampRech" size="20" onFocus="this.value=''" onKeyup="PopulateRech('Modeles',this.value,null)" />
        <input type="hidden" name="ValRech" id="ValRech" />
        </p>
    </div>
    <div class="ContentPanRech">
    <ul id="lesli">
    <li><a id="VR023001" onclick="Choix($(this))">023001 - TABLE OVALE REF 3336</a></li>
    <li><a id="VR170016" onclick="Choix($(this))">170016 - DEBUSSY</a></li>
    </ul>
    </div>
    <div class="FooterPanRech">
    	<p><button id="btnOKPanRech">Ok</button><button class="ML15" id="btnAnnulerPanRech">Annuler</button></p>
    </div>
	<script>
	function InitRech(Quoi) {
		if (Quoi=='Modeles') {
			PopulateRech('Modeles','',function() {
				$('.PanneauRech').show();
			});
			$('#btnAnnulerPanRech').click(function() {
				$('.PanneauRech').hide();
			});
			$('#btnOKPanRech').click(function() {
				if($('#ValRech')=='') {
					alert('Vous devez sélectionner un modèle');
					return false;
				}
				$('.PanneauRech').hide();
				InfoModele();
			});
		} else if (Quoi=='TypeCuir') {
			PopulateRech('TypeCuir','',function() {
				$('.PanneauRech').show();
			});
			$('#btnAnnulerPanRech').click(function() {
				$('.PanneauRech').hide();
			});
			$('#btnOKPanRech').click(function() {
				if($('#ValRech')=='') {
					alert('Vous devez sélectionner un type de cuir');
					return false;
				}
				$('.PanneauRech').hide();
			});
		}
	}
	function Choix(obj) {
		$('#ChampRech').val(obj.text());
		$('#ValRech').val(obj.attr('id').substr(2));
	}
    </script>
</div>
<div id="log"></div>
<footer id="footer">
<p><a onClick="$('#log').toggle()">&copy; Business Advices</a> <span id="cnType"></span></p>
</footer>
<div id="SQL" class="Panneau">
	<a onClick="Go('Main')" class="bRetour">Retour</a>
    <h1 class="ML10">SQL</h1>
    <table>
    <tr><td align="left">Requête : </td><td><textarea name="tsql" id="sqlReq" cols="100" rows="6" />select * from </textarea></td><td align="left"><input type="button" id="btnexec" value="Exécuter" onClick="ExecSQL()"/></td></tr>
    </table>
    <div id="sqlResult">
    </div>
    <script>
	function ExecSQL() {
		var sql=$('#sqlReq').val();
		$('#sqlResult').html('');
		var uneReq=new Requete();
		uneReq.exec(sql, function() {
			var ret='<h2>Résultat</h2><p>'+uneReq.Nb+' enregistrements</p>';
			dump(uneReq.Resu,'sqlResult');
			$('#sqlResult').prepend(ret);
		});
	}
	</script>
</div>
</body>
</html>